package com.perfectmatch.unicampspringboot.services.impl;

import com.perfectmatch.unicampspringboot.db.AvatarDao;
import com.perfectmatch.unicampspringboot.mapper.AvatarMapper;
import com.perfectmatch.unicampspringboot.services.AvatarServices;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

@Service
public class AvatarServicesImpl implements AvatarServices {
    @Autowired
    AvatarMapper avatarMapper;

    public void setAvatar(Long id, String img) {
        AvatarDao dao = avatarMapper.getAvatarById(id.toString());
        if (dao == null) {
            avatarMapper.insertAvatar(id.toString(), img);
        } else {
            avatarMapper.updateAvatar(id.toString(), img);
        }
    }

    static final String defaultAvatar = "data:image/jpeg;base64,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";

    public String getAvatar(Long id) {
        AvatarDao dao = avatarMapper.getAvatarById(id.toString());
        if (dao == null) {
            avatarMapper.insertAvatar(id.toString(), defaultAvatar);
            return defaultAvatar;
        } else {
            return dao.getImg();
        }
    }
}
